async function sendMessage() {
    const input = document.getElementById('userInput');
    const chatBox = document.getElementById('chat-box');
    const userText = input.value;
    if (!userText) return;

    chatBox.innerHTML += `<p><b>Tú:</b> ${userText}</p>`;
    input.value = '';

    // PEGA AQUÍ LA CLAVE DEL PROYECTO NUEVO
    const API_KEY = 'AIzaSyB1HcjdHQBedOOBE09_3w9l3nud3d-WKNk'; 
    const URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-lite:generateContent?key=${API_KEY}`;

    try {
        const response = await fetch(URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                contents: [{ parts: [{ text: userText }] }]
            })
        });

        const data = await response.json();

        if (response.ok && data.candidates) {
            const aiResponse = data.candidates[0].content.parts[0].text;
            chatBox.innerHTML += `<p><b>IA:</b> ${aiResponse}</p>`;
        } else {
            // Esto mostrará el error real (ej: API_KEY_INVALID o QUOTA_EXCEEDED)
            const errorMsg = data.error ? data.error.message : "Error desconocido";
            chatBox.innerHTML += `<p style="color:red"><b>Error de Google:</b> ${errorMsg}</p>`;
        }
    } catch (error) {
        chatBox.innerHTML += `<p style="color:red"><b>Error de red:</b> No se pudo alcanzar el servidor.</p>`;
    }
    chatBox.scrollTop = chatBox.scrollHeight;
}
